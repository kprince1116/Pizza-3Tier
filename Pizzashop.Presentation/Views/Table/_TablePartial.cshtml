@model Pizzashop.DAL.ViewModels.Tableviewmodel


<div class="d-flex align-items-center gap-3 pe-3 justify-content-end">
  <div class=" d-flex justify-content-end position-relative align-items-center ">
    <input type="text" class="search form-control" style="height: 50px;" id="tableSearch" placeholder="Search">
    <img src="~/images/icons/search.svg" alt="" style="width: 20px; aspect-ratio: 1"
      class="bg-white position-absolute rounded-2 m-2" />
  </div>
  <div>
    <img data-bs-toggle="modal" data-bs-target="#exampleModal" class="border delete-icon d-flex p-lg-3 p-2"
      src="~/images/icons/trash (1).svg" alt="">
  </div>
  <div class="border new-item d-flex p-lg-3 p-2" data-bs-toggle="modal" data-bs-target="#AddTable"
    style="background-color: rgb(0, 102, 187); color: white; text-wrap: nowrap;">
    +New Table
  </div>
</div>

<div class=" mt-3 me-3 mb-4 table-responsive">
  <table class="table">
    <thead>
      <tr>
        <div>
          <th scope="col">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked" checked>
              Name
            </div>
        </div>
        </th>
        <th scope="col" style="text-align: center;">Capacity</th>
        <th scope="col" style="text-align: center;">Status</th>
        <th scope="col">Action</th>
      </tr>
    </thead>
    <tbody>
      @foreach (var tables in Model.TableItems)
      {
        <tr>
          <th scope="row">
            <div class="form-check gap-5">
              <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked" checked>
              <div class="d-flex align-items-center gap-1">
                @* <img style="height: 25px;" src="images/dining-menu.png" alt=""> *@
                <div class="d-flex align-items-center text-nowrap">@tables.TableName</div>
              </div>
            </div>
          </th>
          <td style="text-align: center;">
            @tables.Capacity
          </td>
          <td style="text-align: center;">
            @((bool)tables.Isavailable ? "Available" : "Occupied")

          </td>

          <td>
            <img  data-bs-toggle="modal" class="edittable" data-edittableid = "@tables.Tableid" data-bs-target="#EditTable" src="~/images/icons/pen-fill.svg" alt="">
           <img class="delete-table" data-tablesdeleteid="@tables.Tableid" data-bs-toggle="modal" data-bs-target="#deletemodalfortable" src="~/images/icons/trash (1).svg" alt="">
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>

<div class="d-flex table-footer align-items-center justify-content-end gap-lg-2 gap-md-2 gap-1 me-1 me-md-4 me-lg-4">
  <div class="d-flex align-items-center gap-1 items">
    <span class="ps-5 font2">Items Per Page</span>
    <select class="form-select" onchange="changePageSizeForTables()" id="selectpagesizeForTable"
      aria-label="Floating label select example" style="width: 65px;">
      @if (Model.PageSize != null)
      {
        <option value="3" selected="@(Model.PageSize==3 ? true : false)">3</option>
        <option value="5" selected="@(Model.PageSize==5 ? true : false)">5</option>
        <option value="10" selected="@(Model.PageSize==10 ? true : false)">10</option>
        <option value="15" selected="@(Model.PageSize==15 ? true : false)">15</option>
      }
    </select>
  </div>
  <div class="d-flex align-items-center gap-1">
    <span class="font2"> Showing @((Model.CurrentPage - 1) * Model.PageSize +
      1)-@Math.Min(Model.CurrentPage * Model.PageSize, Model.TotalRecords) of
      @Model.TotalRecords</span>
    <div class="pt-3">
      <nav aria-label="Page navigation example">
        <ul class="pagination gap-2">
          <li class="page-item @(Model.CurrentPage>1 ? " " : "disabled") ">
            <a class="page-link" aria-label="Previous" id="@Model." onclick="changePageForTable(@Model.CurrentPage-1)">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
          <li>
            <span class="page-link">@Model.CurrentPage</span>
          </li>
          <li class="page-item @(Model.CurrentPage<Model.TotalPages ? " " : "disabled")  ">
            <a class="page-link" aria-label="Next" onclick="changePageForTable(@Model.CurrentPage+1)">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>



<script>
  
  

    $(document).on('click', '.delete-table', function () {
    var tableId = $(this).data('tablesdeleteid');
    console.log("tableid:",tableId);
    $('#TablesId').val(tableId);
  });



   function changePageSizeForTables() {
    let pagesize = $('#selectpagesizeForTable').val();
    let selectedSectionId = @Model.Sectionid;
    let search = $('#tableSearch').val();

    $.ajax({
      url: '@Url.Action("TablesBySection", "Table")',
      type: "GET",
      data: { id: selectedSectionId, pageSize: pagesize, pageNo: 1, searchKey: search },
      dataType: "html",
      success: function (data) {
        $('#table-container-table').html(data);
      },
      error: function () {
        $('#table-container-table').html("No Data Found");
      }
    });
  }

  function changePageForTable(pageNum) {
    let pagesize = @Model.PageSize;
    let selectedCategoryId = @Model.Sectionid;
    let search = $('#tableSearch').val(); sele

    $.ajax({
      url: '@Url.Action("TablesBySection", "Table")',
      type: "GET",
      data: { id: selectedCategoryId, pageSize: pagesize, pageNo: pageNum, searchKey: search },
      dataType: "html",
      success: function (data) {
        $('#table-container-table').html(data);
      },
      error: function () {
        $('#table-container-table').html("No Data Found");
      }
    });
  } 

</script>




